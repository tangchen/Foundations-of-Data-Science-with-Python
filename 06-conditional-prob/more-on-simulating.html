
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6.5. More on Simulating Conditional Probabilities &#8212; Foundations of Data Science with Python</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.6. Statistical Independence" href="independence.html" />
    <link rel="prev" title="6.4. Relating Conditional and Unconditional Probabilities" href="relating-cond-uncond.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Foundations of Data Science with Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/intro.html">
   Overview
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-intro/intro.html">
   1. Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/who-for.html">
     1.1. Who is this book for?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/why-this-book.html">
     1.2. Why learn data science from this book?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/what-is-data-science.html">
     1.3. What is data science?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/what-book-covers.html">
     1.4. What data science topics does this book cover?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/intro-jupyter-and-python.html">
     1.5. Extremely Brief Intro to Jupyter and Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/jupyter-start.html">
     1.6. Getting Started in Jupyter
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/python-start.html">
     1.7. Getting Started in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-intro/review.html">
     1.8. Review
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-first-stats/intro.html">
   2. First Simulations, Visualizations, and Statistical Tests
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-first-stats/motivating-problem.html">
     2.1. Motivating Problem: Is This Coin Fair?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-first-stats/first-sims.html">
     2.2. First Computer Simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-first-stats/first-vis.html">
     2.3. First Visualizations: Scatter Plots and Histograms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-first-stats/first-stats.html">
     2.4. First Statistical Tests
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-first-stats/review.html">
     2.5. Review
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-first-data/intro.html">
   3. First Visualizations and Statistical Tests with Real Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-first-data/pandas-start.html">
     3.1. Intro to Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-first-data/visualization.html">
     3.2. Visualizing Multiple Data Sets - Part 1: Scatter Plots
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-first-data/partitions.html">
     3.3. Partitions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-first-data/summary-stats.html">
     3.4. Summary Statistics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-first-data/histogram.html">
     3.5. Visualizing Multiple Data Sets - Part 2: Histograms for Partitioned Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-first-data/hypothesis-testing.html">
     3.6. Binary Hypothesis Testing with Real Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-first-data/2d-scatter.html">
     3.7. A Quick Preview of Two-Dimensional Statistical Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-first-data/review.html">
     3.8. Review
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../04-probability1/intro.html">
   4. Introduction to Probability
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-probability1/outcomes-samplespaces-events.html">
     4.1. Outcomes, Sample Spaces, and Events
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-probability1/relative-frequency.html">
     4.2. Relative Frequencies and Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-probability1/fair-experiments.html">
     4.3. Fair Experiments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-probability1/axiomatic-prob.html">
     4.4. Axiomatic  Probability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-probability1/corollaries.html">
     4.5. Corollaries to the Axioms of Probability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-probability1/combinatorics.html">
     4.6. Combinatorics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-probability1/review.html">
     4.7. Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../04-probability1/summary.html">
     4.8. Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05-binary-hypothesis-testing/outline.html">
   5. Binary Hypothesis Tests with Resampling (Outline)
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="intro.html">
   6. Dependence and Independence
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="simulating-cond-probs.html">
     6.1. Simulating and Counting Conditional Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="notation-and-intuition.html">
     6.2. Conditional Probability: Notation and Intuition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="definition.html">
     6.3. Formally Defining Conditional Probability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="relating-cond-uncond.html">
     6.4. Relating Conditional and Unconditional Probabilities
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.5. More on Simulating Conditional Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="independence.html">
     6.6. Statistical Independence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="fair-exps.html">
     6.7. Conditional Probabilities and Independence in Fair Experiments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="conditional-independence.html">
     6.8. Conditioning and (In)dependence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chain-rules-total-prob.html">
     6.9. Chain Rules and Total Probability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="review.html">
     6.10. Review
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="summary.html">
     6.11. Summary
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07-bayesian-methods/outline.html">
   7. Introduction to Bayesian Methods (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08-random-variables/outline.html">
   8. Random Variables (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09-moments/outline.html">
   9. Moments, Parameter Estimation, and Binary Hypothesis Tests on Sample Means (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../10-conditional-stats/outline.html">
   10. Applications of Conditional Distributions to Statistical Tests (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../11-matrix-vector-regression/outline.html">
   11. Multidimensional Data and Regression (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../12-categorical-data/outline.html">
   12. Tests of Independence for Categorical Data (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../13-clustering-transforming/outline.html">
   13. Clustering and Transforming Multi-dimensional Data (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../14-matrix-applications/outline.html">
   14. Applications of Matrices to Solving Equations, Curve Fitting, and Regression (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../15-multidim-dependence/outline.html">
   15. Working with Dependent Data in Multiple Dimensions (Outline)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../16-next-steps/outline.html">
   16. Next Steps (Outline)
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/06-conditional-prob/more-on-simulating.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/06-conditional-prob/more-on-simulating.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="more-on-simulating-conditional-probabilities">
<h1><span class="section-number">6.5. </span>More on Simulating Conditional Probabilities<a class="headerlink" href="#more-on-simulating-conditional-probabilities" title="Permalink to this headline">¶</a></h1>
<p>Simulation is a key technique used in this book to explore random phenomena. Thus, it is important to understand the simulation techniques we use for different scenarios. Consider again the Magician’s Coin problem, and let <span class="math notranslate nohighlight">\(H_i\)</span> denote the event that the coin comes up heads on the <span class="math notranslate nohighlight">\(i\)</span>th flip. In <a class="reference internal" href="simulating-cond-probs.html"><span class="doc">Simulating and Counting Conditional Probabilities</span></a>, we investigated <span class="math notranslate nohighlight">\(P(H_2|H_1)\)</span>, the probability of getting Heads on a second flip of the chosen coin given that heads was observed on the first flip.  If we apply the definition of conditional probability from <a class="reference internal" href="definition.html"><span class="doc">Formally Defining Conditional Probability</span></a>, then we can calculate this probability as</p>
<!--
\begin{equation}
P(H_2|H_1) = \frac{P(H_1 \cap H_2)}{P(H_1)}.
\label{eq:p-h2-given-h1}
\end{equation}
-->
<div class="math notranslate nohighlight" id="equation-eq-p-h2-given-h1">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-eq-p-h2-given-h1" title="Permalink to this equation">¶</a></span>\[
P(H_2|H_1) = \frac{P(H_1 \cap H_2)}{P(H_1)}.
\]</div>
<p>However, in <a class="reference internal" href="simulating-cond-probs.html"><span class="doc">Simulating and Counting Conditional Probabilities</span></a>, we did not estimate either <span class="math notranslate nohighlight">\(P(H_1 \cap H_2)\)</span> or <span class="math notranslate nohighlight">\(P(H_1)\)</span>.  Instead, we counted the proportion of times that we observed the outcome <span class="math notranslate nohighlight">\(H_2\)</span> when <span class="math notranslate nohighlight">\(H_1\)</span> was the outcome of the first flip.  Let’s see why these produce the same result.</p>
<p>Let’s see how we would estimate the probabilities on the right-hand side of <a class="reference internal" href="#equation-eq-p-h2-given-h1">(6.1)</a>. We will use the following notation for the counters we have in the simulation:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N\)</span> is the total number of simulation trials,</p></li>
<li><p><span class="math notranslate nohighlight">\(N_1\)</span> is the number of simulation trials in which the outcome of flip 1 was Heads (i.e., the number of times <span class="math notranslate nohighlight">\(H_1\)</span> occurred), and</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{12}\)</span> is the number of simulation trials in which the outcomes of both flip 1 and flip 2 were Heads (i.e., the number of times <span class="math notranslate nohighlight">\(H_1 \cap H_2\)</span> was observed.</p></li>
</ul>
<p>Now, we can estimate the probability of <span class="math notranslate nohighlight">\(H_1\)</span> using its relative frequency,</p>
<div class="math notranslate nohighlight">
\[
P(H_1) = \frac{N_1}{N}.
\]</div>
<p>Similarly, we can estimate the probability of <span class="math notranslate nohighlight">\(H_1 \cap H_2\)</span> using its relative frequency,</p>
<div class="math notranslate nohighlight">
\[ 
P(H_1 \cap H_2) =\frac{N_{12}}{N}.
\]</div>
<p>If we substitute these into <a class="reference internal" href="#equation-eq-p-h2-given-h1">(6.1)</a>, we get</p>
<div class="math notranslate nohighlight">
\[
P(H_2|H_1) = \frac{ \frac{N_{12}}{N} }{ \frac{N_1}{N} }= \frac{ N_{12} }{ N_1 }.
\]</div>
<p>I.e., the result is the same as the approach taken in <a class="reference internal" href="simulating-cond-probs.html"><span class="doc">Simulating and Counting Conditional Probabilities</span></a>. In general, we can directly estimate the conditional probability of an event <span class="math notranslate nohighlight">\(B\)</span> given an event <span class="math notranslate nohighlight">\(A\)</span> using nested if statements to:</p>
<ul class="simple">
<li><p>Count the number of trials in which <span class="math notranslate nohighlight">\(A\)</span> occurred. Call this number <span class="math notranslate nohighlight">\(N_A\)</span></p></li>
<li><p>Within those trials in which  <span class="math notranslate nohighlight">\(A\)</span> occurred, count the number of trials in which <span class="math notranslate nohighlight">\(B\)</span> also occurred. Call this number <span class="math notranslate nohighlight">\(N_{AB}\)</span>.</p></li>
<li><p>Estimate the conditional probability of <span class="math notranslate nohighlight">\(B\)</span> occurring given that <span class="math notranslate nohighlight">\(A\)</span> occurred as</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
P(B|A) \approx \frac{N_{AB}}{N_A}
\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that when designing simulation to estimate conditional probabilities, you must be especially careful in selecting the number of trials to be simulated.</p>
<p>In simulations of single events, if we think we know the approximate probability of the event, we can use that probability to estimate the number of trials needed to estimate it. For example, if we are estimating a probability <span class="math notranslate nohighlight">\(P(A)\)</span> that we believe is close to 0.1, then we can estimate that the event <span class="math notranslate nohighlight">\(A\)</span> occurs approximately once in every <span class="math notranslate nohighlight">\(1/P_A=10\)</span> trials. If we capture 100 instances of <span class="math notranslate nohighlight">\(A\)</span> occurring, we will get a good estimate of <span class="math notranslate nohighlight">\(P(A)\)</span>, so we might use this information to simulate <span class="math notranslate nohighlight">\(100/P_A=1000\)</span> trials.</p>
<p>This approach will not work to estimate a conditional probability!</p>
<p><span style="color:red;font-weight:bold">It is not sufficient to use only a conditional probability to estimate the number of trials needed.</span></p>
<p>Let’s use an example to show why this is the case. Suppose <span class="math notranslate nohighlight">\(A\)</span> and  <span class="math notranslate nohighlight">\(B\)</span> are events for which we wish to estimate the conditional probability <span class="math notranslate nohighlight">\(P(B|A)\)</span>. Consider the scenario where <span class="math notranslate nohighlight">\(P(A)=10^{-3}\)</span> and <span class="math notranslate nohighlight">\(P(A \cap B= 9 \times 10^{-4}\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[
P(B|A) = \frac{P(A \cap B)}{P(A)} = \frac{9 \times 10^{-4}}{10^{-3}} = 0.9.
\]</div>
<p>If we used only the knowledge of <span class="math notranslate nohighlight">\(P(B|A)\)</span>, then we might use <span class="math notranslate nohighlight">\(100/P(B|A) \approx 111\)</span> trials. But remember that in the simulation, we estimate the conditional probability as</p>
<div class="math notranslate nohighlight">
\[
P(B|A) \approx \frac{N_{AB}}{N_A}.
\]</div>
<p>We can estimate the values of these counters as follows. (We will formalize the meaning of these estimates later in the book when we talk about expected values/ensemble means.) <span class="math notranslate nohighlight">\(N_A\)</span> will be approximately equal to the number of trials times <span class="math notranslate nohighlight">\(P(A)\)</span>, so it will be approximately equal to <span class="math notranslate nohighlight">\(111 P(A)= 0.11\)</span>. In other words, in 111 trials, most of the time we will not see any event <span class="math notranslate nohighlight">\(A\)</span> occur. The estimated value of counter <span class="math notranslate nohighlight">\(N_{AB}\)</span> will be the estimated number of trials in which we see both <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> occur, which will be approximately equal to <span class="math notranslate nohighlight">\(111 P(A \cap B) \approx 0.1\)</span>. <strong>If we only use  the conditional probability information, we may severely underestimate the number of trials required to observe a sufficient number of events.</strong></p>
<p><span class="math notranslate nohighlight">\(\Rightarrow\)</span> When determining a sufficient number of trials for a simulation of a conditional probability <span class="math notranslate nohighlight">\(P(B|A)\)</span>, we must determine the required number of trials from the (estimated) value of <span class="math notranslate nohighlight">\(P(A \cap B)\)</span>, if known. If no information about <span class="math notranslate nohighlight">\(P(A \cap B)\)</span> is available, the value of <span class="math notranslate nohighlight">\(N_{AB}\)</span> should be checked at the end of the simulation to make sure that a sufficient number of events (at least 10; 100 is better) were observed.</p>
<p>Because of this effect, some people will code their simulation to run until <span class="math notranslate nohighlight">\(N_{AB}\)</span> reaches a specific threshold. This will bias the estimate of the <span class="math notranslate nohighlight">\(P(B|A)\)</span> for reasons that are beyond the scope of this book. However, the bias will be small if threshold is large (&gt;100).</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./06-conditional-prob"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="relating-cond-uncond.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6.4. </span>Relating Conditional and Unconditional Probabilities</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="independence.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.6. </span>Statistical Independence</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By John M. Shea<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>